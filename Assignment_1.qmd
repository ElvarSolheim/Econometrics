---
title: "Assignment_1"
format: html
editor: visual
---

```{r}
#| label: setup
#| echo: false
#| output: false
#| message: false
library(tidyverse)
library(readxl)
library(magrittr)
```

# Assignment 1: Data and Descriptive

This assignment aims to obtain, process, and analyze sub-national GDP and population data for a subset of European countries.
The selected subset comprises the UK, Czech Republic, Turkey, and Finland.
The objective is to calculate GDP per capita and explore regional inequity using a range of descriptive statistics and visualizations.

## Part A: Sub-national GDP and GDP per Capita

In the first part, we will dive into sub-national GDP for the selected European countries.
Firstly, a brief overview of the data acquisition will be given.
Furthermore, we will calculate GDP per capita for each sub-region.
Lastly, we will provide a descriptive analysis that provides insights into the central tendencies of the data.

### Data Acquisition

The datasets used in this assignment include sub-regional data on GDP and population for each of the European countries in the subset.
The NUTS classification is a hierarchical system that enables cross-border statistical comparisons at various regional levels within the EU and UK.
In this assignment we will use NUTS 3 data.
This is the most detailed level of the NUTS classification system, dividing regions into smaller administrative units.

We obtained data for Czech Republic, Turkey and Finland from Eurostat.
We downloaded two sub-regional datasets, one providing GDP data (nama_10r_3gdp) and the other one providing population data (demo_r_pjanaggr3).
The datasets contains data from year 2000 to 2020.
We only needed a few of the variables included in the two datasets.
We used the select()-function to pick the variables we wanted and gave them some more appropriate names.
We ended up with three variables in each dataset; "year", "geo", "gdp"/"pop".

```{r}
# GDP data for Czech Republic, Turkey and Finland
gdp_data <- read_csv("nama_10r_3gdp__custom_7667248_linear.csv") |>
  select(year = TIME_PERIOD, geo, gdp = OBS_VALUE)
```

```{r}
# Population data for Czech Republic, Turkey and Finland
population_data <- read_csv("demo_r_pjanaggr3__custom_7667383_linear.csv") |>
  select(year = TIME_PERIOD, geo, pop = OBS_VALUE)
```

The UK was not included in the two datasets obtained from Eurostat, since the country is no longer a part of the EU.
We got sub-regional GDP and population data for the UK through ...

```{r}
# GDP data for UK
gdp_UK <- read_excel("regionalgrossdomesticproductgdpallitlregions.xlsx", 
    sheet = "Table 5", skip = 1)
```

```{r}
# Population data for UK
population_UK <- read_excel("regionalgrossdomesticproductgdpallitlregions.xlsx", 
    sheet = "Table 6", skip = 1)
```

To get the two UK datasets in the same format as the datasets from Eurostat, we used the gather()-function to convert the dataset from wide to long format.
With filter() and mutate() we created a "geo" variable, describing the sub-regions.
We used the select()-function to pick the same variables as we have in the datasets for the EU countries; "year", "geo", "gdp" and "pop".
Lastly, we sorted the datasets by "geo".

```{r}
# Reforming gdp_UK
gdp_UK <- gdp_UK %>%
  gather(year, gdp, -ITL, -`ITL code`, -`Region name`) %>%
  filter(ITL == "ITL3") %>%
  mutate(geo = `ITL code`) %>%
  select(year, geo, gdp) %>%
  arrange(geo)
```

```{r}
# Reforming population_UK
population_UK <- population_UK %>%
  gather(year, pop, -ITL, -`ITL code`, -`Region name`) %>%
  filter(ITL == "ITL3") %>%
  mutate(geo =`ITL code`) %>%
  select(year, geo, pop) %>%
  arrange(geo)
```

We merged the gdp dataset and the population dataset for Czech Republic, Turkey and Finland together.
We did the same thing with the two datasets for UK.
Finally, we merged the dataset for Czech Republic, Turkey and Finland with the dataset for the UK.
We named the dataset containing sub-regional GDP and population data for all the countries for "main_dataset".

```{r}
# Merging gdp dataset and population dataset for Czech Republic, Turkey and Finland
merged_data <- gdp_data |>
  left_join(population_data, join_by(year,geo))
```

```{r}
# Merging gdp dataset and population dataset for UK
merged_UK <- gdp_UK |>
  left_join(population_UK, join_by(year,geo))
```

```{r}
# Converting year to a charachter
merged_data$year <- as.character(merged_data$year)
merged_UK$year <- as.character(merged_UK$year)
```

```{r}
# Merging all datasets to a main dataset
main_data <- full_join(merged_data, merged_UK)
```

```{r}
# Clean up
rm(gdp_data, population_data, gdp_UK, population_UK, merged_data, merged_UK)
```

### GDP per Capita Calculation

To compute GDP per capita for each sub-region we used the formula:

$y_{i} = \frac{GDP_{i}}{Population_{i}}$

### Descriptive Analysis

## Part B: Regional Inequity

The second part focuses on regional inequality.
We will start with a literate review of the subject, then compute population-weighted GDP Gini coefficients for the regions within our subset of European countries.
This includes data presentation through descriptive statistics and visuals.
In the end, we will discuss the computed Gini coefficients and reflect on the implications of our findings in the context of regional inequity.

### Literature Review

Regional inequality refers to the disparities in economic development, income, and other socio-economic indicators among different geographical regions within a country or across countries.

We should care about regional inequality because it is essential for sustainable and inclusive development in the future.
Regional inequality can have significant social, economic, and political implications.
High levels can lead to issues like unequal distribution of resources, limited social mobility, and even political instability.
Addressing regional inequality is important for ensuring that the benefits of economic growth are shared more equitably among all citizens.
It is all about creating a more balanced and fair society.

### Gini Coefficient Calculation

To compute the population-weighted GDP Gini coefficient for each European NUTS 2 level region within the subset of countries, we used the NUTS 3 level GDP per capita data and the formula below:

$GINW_j=\frac{1}{2\overline y j} \sum_{i}^{n_j} \sum_{l}^{n_j} \frac{p_i}{P_j} \frac{p_l}{P_j} |y_i - y_l|$

### Data Presentation

### Discussion
