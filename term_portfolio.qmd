---
title: "Regional development and inequality"
format: pdf
editor: visual
bibliography: MSB104.bib
---

Western Norway University of Applied Sciences\
MSB104 Econometrics\
Hanna Sundal Bjerkreim & Elvar Solheim

```{r}
#| label: setup
#| echo: false
#| output: false
#| message: false
library(tidyverse)
library(readxl)
library(magrittr)
library(knitr)
library(dineq)
library(ineq)
library(ggplot2)
library(scales)
library(cowplot)
library(dplyr)
library(huxtable)
library(vtable)
library(future)
library(furrr)
library(lmtest)
library(plm)
```

# I. Introduction

## Background

Regional development, a cruical component of economic growth, represents a collective effort to enhance well-being and living standards in specific geographic areas, playing a vital role in contributing to national performance and fostering resilient and inclusive societies [@oecd].
As regions navigate the intricate dynamics of growth, decline, and adaptation, a multitude of economic, social, and environmental outcomes emerges [@pike2016].
These variations give rise to the concept of regional inequality - a phenomenon rooted in the uneven distribution of resources, opportunities, and development across different regions.
Regional inequality posting a fundamental challenge for human society, a central focus of academic research, and a major concern of governments [@wei2015].
There has been a long-lasting debate about the scope, dimensions, trajectory, mechanisms, and consequences of regional inequality, along with the policies that address disparity [@wei2015].
We should care about regional inequality because it is essential for both the economy and social welfare in general.
The potential consequences of regional inequality are many, and when certain regions experience higher levels of economic development and prosperity compared to others, it can have far-reaching consequences.
@lessmann2017 highlights a correlation between regional inequality and personal income inequality, ethnic inequality, and political stability.
These consequences underline the importance of addressing regional imbalances within countries, as they may independently contribute to economic outcomes and exacerbate issues such as income inequality, ethnic tensions, and segregation.

Given this context, this paper delves into the intricate dynamics of regional development and inequality within a subset of European countries.
The subset comprises the Czech Republic, Turkey, Finland and the United Kingdom.
Analysing these countries provides a nuanced understanding of regional development and inequality, offering insights into potential policy interventions aimed at fostering more balanced and inclusive development pathways.

## Objectives

Throughout the semester in our econometrics course, we completed three distinct assignments, each contributing to a comprehensive understanding of regional development and inequality within the Czech Republic, Turkey, Finland and the United Kingdom.

The primary objective of the first assignment was to acquire, process, and analyse sub-national GDP and population data, aiming to answer questions about regional economic disparities.
This involved calculating GDP per capita and the population-weighted GDP Gini coefficient, and exploring regional inequality through descriptive statistics and visualizations.

In the second assignment, the objective shifted towards investigating the relationship between regional development and inequality for the year 2010.
We delved into questions regarding the nature of this relationship, utilizing cross-sectional estimation techniques.
Starting with simple linear regression, we explored the initial relationship and expanded our analysis by introducing potential determinants through multiple linear regression.

In the third assignment, our aim was to explore alternative function forms, specifically logarithmic and quadratic, as well as implementing panel estimates to scrutinize the relationship between regional development and inequality.
We compared the alternative models and the panel estimates with the cross-sectional estimates obtained earlier.

Synthesizing the critical findings from Assignments 1, 2, and 3, this paper aims to provide a cohesive understanding of regional development and inequality within the specified countries.
By shedding light on the complexities of this issue and answering these specific research questions, we aim to offer valuable insights that can help policy-making and practice in the realm of regional development and inequality.

## Significance

The exploration of regional development and inequality within the context of the Czech Republic, Turkey, Finland and the United Kingdom reveals important insights into the dynamics of economic growth and diparities at regional levels.

In a time characterized by increasing interconnectedness, understanding the intricacies of regional development is imperative.
Regional development not only shapes the well-being and living standards of regions but also plays a crucial role in bolstering national performance.
The findings from this research not only contribute to the specific knowledge of the Czech Republic, Tureky, Finland and the United Kingdom, but also provides information for understanding regional disparities globally.
By identifying patterns of regional development and inequality within these specific countries, this study offers a valuable understanding that can be applied to similar challenges faced by nations globally.

Furthermore, this research provides valuable insights that can guide policy-makers, economists, and social scientists.
The uneven distribution of resources, opportunities, and development underscores the importance of addressing these issues, especially as the impacts of regional inequality are more pronounced than ever.
The pressing concern of regional inequality highlights the necessity for a nuanced analysis to inform targeted policies and initiatives.
Policies promoting balanced growth and mitigating disparities among regions take on heightened relevance in the current global context.

This research not only expands the understanding of regional dynamics but also equips with the knowledge needed for more balanced and inclusive development pathways, fostering a more equitable global future.

# II. Literature Review

## Previous Work

The Kuznets curve has been one of the most debated hyphotesis in development economics.
Orignally, @kuznets1955 introduced this curve to illustrate the relationship between per capita income and income inequality.
The hypothesis says that income inequality should follow an inverted U-shape along the development process, where it first increases, then peaks, and then decreases.
This hypothesis may also apply to regional inequality.
The idea is that the development in extremely poor economies, typically starts in one part of the country, leading to these regions become richer than the rest.
Consequently, regional inequality rise at low levels of development.
A higher level of development, the less developed regions catch up, fostering a convergence process [@lessmann2017].
There is empirical evidence for the inverted U-shape in regional inequality, for example @barrios2009 study of the dynamics of regional inequalities.
@lessmann2017 also find strong support for the inverted-U, as well as evidence that regional inequality is increase again at very high levels of development.

In general are the empirical studies on regional inequality is limited to a specific country sample with a general bias towards medium and high income economies.
This is a issue when investigating the upward sloping part of the Kuznets curve.
The challenge is obtaining data from the less developed regions in the world.
The poorest regions appear as blank spots on the map.
@lessmann2017 fill this research gap by predicting regional incomes using satellite night-time light data for the countries with no reliable statistical data available.
The higher night-time light intensity, the higher level of economic activity.
The data on the very poorest countries allowed @lessmann2017 to estimate the upward sloping part of the Kuznets curve in regional inequalities.
They found that the relationship between regional development and regional inequality follow a pattern similar to a N-shape.
By examining changes in inequality over time, @lessmann2017 found that the majority of all countries experience sigma convergence, which means that regional inequality decreases over time.
However, they found that some poor and lower-middle-income countries, along with some rich economies, show divergence.
This shows that very poor countries exhibit increasing inequalities, while most middle- and high-income countries show decreasing or stabilizing inequalities.
Interestingly, regional inequalities increase again in the richest countries, forming the right side of the N-shaped pattern [@lessmann2017].

## Research Gap

The literature review highlighted the significance of the Kuznets curve in development economics and brought attention to a research gap in the litterature.
Empirical studies on regional inequality seems to often be limited to specific country sample with a general bias towards medium and high-income economies.
This limitation poses a challenge when exploring the ascending part of the Kuznets curve, as obtaining data from less developed regions are difficult.

In this paper we aim to help cover this gap in the literature, by exploring the relationship between regional development and inequality within a subset of European countries, providing insights into the dynamics of regional inequality in a diverse set of countries, which include both medium to high and lower-income regions.
The inclusion of this particular set of countries gives our research a distinctive character, offering a unique combination for comparisons.
The study allowing a nuanced exploration of regional development and inequality within the specific context of the Czech Republic, Turkey, Finland, and the United Kingdom.

# III. Data and Methodology

## Data Sources

In the assignments, the primary data sources used were Eurostat and the Office for National Statistics (ONS).
Eurostat provided sub-regional data on GDP and population for the EU countries (Czech Republic, Turkey and Finland).
For the United Kingdom, which is not a part of the EU, ONS supplied sub-regional GDP and population data.
The datasets we downloaded from Eurostat included regions at a NUTS3 level.
Following Brexit, the ONS developed a domestic statistical classification framework separate from NUTS, refferd to as International Territorial Levels (ITLs).
This system aligns with the NUTS classification, enabling comparability.
The dataset downloaded from ONS included regions at a ITL3 level, which corresponds to the NUTS3 level.
Some manipulations of the raw data was necessary to obtain comparable value.
The datasets from Eurostat and ONS were merged to one main dataset containing GDP and population data at a NUTS3-level for the years 2000 to 2020.
The main dataset is based on 4 countries and 294 NUTS3 regions.
Later we generated another dataset for the NUTS2 regions.
The dataset includes GDP measured at current market prices in millions of euros for Czech Republic, Turkey, and Finland.

Later in the analysis we included three potential determinants of regional inequality alongside regional development, for the NUTS2 regions in Turkey for the year 2010.
Eurostat was the source for the additional data on unemployment, infrastructure, and life expectancy.

Limitations may arise from variations in data collection methods between Eurostat and ONS, as well as potential differences in classification systems between the EU and the United Kingdom.
The shift from the NUTS to the ITL classification system for the United Kingdom after Brexit, introduces a potential limitation.
While efforts are made to align the two classification systems, differences or uncertainties may still exist.
Even with efforts to align ITLs with NUTS, there might be subtle differences that could affect the comparability of data between the United Kindom and the other EU countries.\
The difference in currency units in the GDP data between the EU countries (million euros) and the United Kingdom (million pounds) introduces a source of complexity.
This should have been taken care of in the data manipulation, which was not done.

```{r}
#| echo: false
#| output: false
# GDP data for Czech Republic, Turkey and Finland
gdp_data <- read_csv("nama_10r_3gdp__custom_7667248_linear.csv") |>
  filter(unit == "MIO_EUR") |>
  select(year = TIME_PERIOD, geo, gdp = OBS_VALUE)
```

```{r}
#| echo: false
#| output: false
# Population data for Czech Republic, Turkey and Finland
population_data <- read_csv("demo_r_pjanaggr3__custom_7667383_linear.csv") |>
  select(year = TIME_PERIOD, geo, pop = OBS_VALUE)
```

```{r}
#| echo: false
# GDP data for UK
gdp_UK <- read_excel("regionalgrossdomesticproductgdpallitlregions.xlsx", 
    sheet = "Table 5", skip = 1)
```

```{r}
#| echo: false
# Population data for UK
population_UK <- read_excel("regionalgrossdomesticproductgdpallitlregions.xlsx", 
    sheet = "Table 6", skip = 1)
```

```{r}
#| echo: false
# Reforming gdp_UK
gdp_UK <- gdp_UK %>%
  gather(year, gdp, -ITL, -`ITL code`, -`Region name`) %>%
  filter(ITL == "ITL3") %>%
  mutate(geo = `ITL code`) %>%
  select(year, geo, gdp) %>%
  arrange(geo)
```

```{r}
#| echo: false
# Reforming population_UK
population_UK <- population_UK %>%
  gather(year, pop, -ITL, -`ITL code`, -`Region name`) %>%
  filter(ITL == "ITL3") %>%
  mutate(geo = `ITL code`) %>%
  select(year, geo, pop) %>%
  arrange(geo)
```

```{r}
#| echo: false
# Merging gdp dataset with population dataset for the EU countries
merged_data <- gdp_data |>
  left_join(population_data, join_by(year,geo))
```

```{r}
#| echo: false
# Merging gdp dataset with population dataset for the UK
merged_UK <- gdp_UK |>
  left_join(population_UK, join_by(year,geo))
merged_UK$geo <- gsub("TL", "UK", merged_UK$geo)
```

```{r}
#| echo: false
# Converting the "year" variable into a character
merged_data$year <- as.character(merged_data$year)
merged_UK$year <- as.character(merged_UK$year)
```

```{r}
#| echo: false
#| output: false
# Merging EU dataset with UK dataset
main_data <- full_join(merged_data, merged_UK)
```

```{r}
#| echo: false
# We only want data from year 2000 to 2020
main_data <- main_data %>%
  subset(main_data$year >= 2000 & main_data$year <= 2020) %>%
  select(year, geo, pop, gdp)
```

```{r}
#| echo: false
# Clean up
rm(gdp_data, population_data, gdp_UK, population_UK, merged_data, merged_UK)
```

## Methodological Approach

We initiated our analysis by computing GDP per capita, serving as a measure for Regional development, and the population-weighted GDP Gini coefficient as a measure of regional inequality.
Subsequently, we conducted cross-sectional estimates, including a simple linear regression model and a multiple linear regression model.
Further, we explored alternative forms, incorporating a logarithmic model and a quadratic model.
Lastly, we extended our analysis to panel estimates.

### Regional development measure

We used GDP per capita as a measure of regional development.
GDP per capita gives an average representation of the economic well-being of the individuals, indicating the amount of economic output generated, by each person.
A higher GDP per capita indicates greater economic prosperity.
GDP per capita is good measure for assessing regional development, because it provides an indicator of the overall living standard in each region.
Additionally, GDP per capita is widely used and easily comparable across regions and countries.
We computed the GDP per capita for each sub-region using the formula: $y_{i} = \frac{GDP_{i}}{Population_{i}}$.

```{r}
#| echo: false
# Adding GDP per capita in the main_data
main_data <- main_data %>%
  mutate(gdp_per_capita = gdp / pop)
```

For the United Kingdom, GDP is measured at current market prices in millions of pounds.
The population variable represents the total annual population within each sub-region.
Consequently, the GDP per capita variable expresses GDP in millions of euros/pounds per capita in each sub-region.
In the regression models the GDP per capita is multiplied with 100.
The scaling helps make the numbers more manageable and interpretable in the context of the regression analysis.

### Regional inequality measure

Measuring regional inequality is challenging because it is difficult to compare regions of different sizes.
To deal with this issue, we use a population-weighted Gini coefficient that accounts for regions of different sizes.
This measure offers a way to assess the degree of regional inequality, allowing for comparison across regions and countries.
The population-weighted is chosen for measuring regional inequality, because it gives a nuanced view of regional inequality considering both GDP disparities and the population size in each region.
The population-weighted GDP Gini coefficient for each sub-region was computed by using the formula: $GINW_j=\frac{1}{2\overline y j} \sum_{i}^{n_j} \sum_{l}^{n_j} \frac{p_i}{P_j} \frac{p_l}{P_j} |y_i - y_l|$.

```{r}
#| echo: false
# Creating a NUTS 0, NUTS 2 and NUTS 3 level
main_data_nuts2 <- main_data |>
  mutate(id_nuts3 = geo,
         id_nuts2 = substr(geo, 1,4),
         id_nuts0 = substr(geo, 1, 2)
         )
```

```{r}
#| echo: false
main_data_nuts2 <- main_data_nuts2 |>
  # Removing NA`s 
  filter(pop != "NA") |>
  filter(pop != 0) |>
  filter(gdp_per_capita != "NA") |>
  group_by(id_nuts2, year) |>
  # Adding Gini coefficient, population, GDP and GDP per capita for the NUTS 2 regions
  mutate(gini_n2 = gini.wtd(gdp_per_capita, weights = pop), 
         pop_n2 = sum(pop),
         gdp_n2 = mean(gdp),
         gdp_per_capita_n2 = mean(gdp_per_capita)
         ) |>
  ungroup()
```

```{r}
#| echo: false
# Selecting only the NUTS 2 variables
main_data_nuts2 <- main_data_nuts2 %>%
   select(year, -geo, -gdp, -pop, -gdp_per_capita, -id_nuts3, id_nuts0, id_nuts2, pop_n2, gdp_n2, gdp_per_capita_n2, gini_n2)
```

```{r}
#| echo: false
# Selecting only the first row of each group 
main_data_nuts2 <- main_data_nuts2 |>
 group_by(id_nuts2, year) |>
  slice(1) 
```

### Cross-sectional estimates

```{r}
#| echo: false
# Subset including nuts2 regions in 2010
subset_nuts2_2010 <- main_data_nuts2 |>
  filter(grepl("2010", year))
```

***Simple Linear Regression***

To see how regional development affects regional inequality we estimated a simple linear regression model with the population-weighted GDP Gini coefficient ($GINIW_j$) as the dependent variable and the GDP per capita ($y_j$ ) as the independent variable.
For the estimation we used a subset including only observations on NUTS 2 regions from the year 2010.
We estimated three models for a better insight into how the relationship between regional inequality and regional development is in the different countries.
The first model included data from all our countries, the second model focused only on EU countries, while the third model was all about the United Kingdom.
We dedicate a separate model to the United Kingdom, since the country accounted for almost half of the observations in our dataset.
Below is the equation for our simple linear regression model: $\hat{GINIW_{2010}} = \hat{\beta}_0 + \hat{\beta}_1 y_{2010}$.

```{r}
#| echo: false
#| label: tbl-slr
#| tbl-cap: "Simple Linear Regression" 
# Estimate for all the countries
lm1 <- lm(gini_n2 ~ I(gdp_per_capita_n2 * 100) , data = subset_nuts2_2010)

# Estimate for the UK
lm2 <- subset_nuts2_2010 %>% 
  filter(id_nuts0 == "UK") %>% 
  lm(gini_n2 ~ I(gdp_per_capita_n2 * 100), data = .)

# Estimate for the EU countries
lm3 <- subset_nuts2_2010 %>% 
  filter(id_nuts0 %in% c("CZ", "FI", "TR")) %>% 
  lm(gini_n2 ~ I(gdp_per_capita_n2 * 100), data = .)

# Generate regression table
huxreg(
  list("All Countries" = lm1, "UK" = lm2, "EU" = lm3),
  statistics = c(N = "nobs", R2 = "r.squared"),
  coefs = c("GDPpc" = "I(gdp_per_capita_n2 * 100)", Constant = "(Intercept)"),
  stars = c(`***` = 0.01, `**` = 0.05, `*` = 0.10)
  )
```

The results from the simple linear regression are reported in @tbl-slr.
The coefficient for GDP per capita represents the estimated change in the GDP Gini coefficient (regional inequality) for a one unit change in GDP per capita (regional development).
The regression table reveals a positive relationship between regional development and regional inequality in the first model for all the countries and in the second model for the United Kingdom.
In the model for all countries, a one-unit increase in GDP per capita corresponds to an average rise of 0.026 in the Gini coefficient.
This coefficient is significant at a 1% significance level.
The second model, focused on the United Kingdom, strengthens this association, indicating a slightly higher increase of 0.032 in the Gini coefficient with a rise in GDP per capita.
This Gini coefficient is also highly significant at a 1% significance level.
However, in the third model for the EU countries, the relationship between regional development and regional inequality is negative.
Here, a one-unit increase in GDP per capita is linked to a 0.012 decrease in the Gini coefficient, suggesting that higher regional development in these countries is paradoxically associated with lower regional inequality.
This relationship is significant at a 5% significance level.
All three models show relatively small standard errors, suggesting reasonable reliability in estimating the coefficients.
In the model for all the countries, the standard error for the GDP per capita coefficient is 0.003.
The standard error is 0.004 for the UK model and 0.005 for the EU model.

The constant term represents the estimated value of the GDP Gini coefficient when GDP per capita is zero.
In the context of regional development, this might not have a meaningful interpretation, since there always will be some development in the regions.

We examine the goodness of fit by looking at the R-squared.
The R-squared values indicate the proportion of variation in the Gini coefficient that can be explained by the GDP per capita in each model.
The closer R-squared is to 1, the better the model is at explaining the variability.
The first model have a R-squared of 0.418, indicating that about 41.8% of the variability in the population-weighted Gini coefficient can be explained by the variation in GDP per capita.
In the second model, a higher R-squared of 0.602 suggest that the GDP per capita variable in this model does a better job of explaining the variability in regional inequality.
The third model has the lowest R-squared among the three models.
In the third model, the R-squared is 0.131, indicating that only 13.1% of the variability is explained.
This model seems to be less effective in capturing the relationship between regional development and regional inequality compared to the other models.

***Multiple Linear Regression***

We estimated a multiple linear regression model incorporating unemployment, infrastructure and life expectancy alongside regional development, as potential determinants of regional inequality.
We estimated this for the NUTS 2 regions in Turkey for the year 2010.
While the United Kingdom has the overall highest number of observations in our sample, sourcing data on various determinants was challenging.
Consequently, we opted to delve deeper into Turkey, the country with the second-highest number of observations.
With the population-weighted GDP Gini coefficient ($GINIW_j$) as the dependent variable and the GDP per capita ($y_j$ ), unemployment (${Unemployment}_{2010}$), life expectancy (${Life Expectancy}_{2010}$) and infrastructure (${Infrastructure}_{2010}$) as the independent variables we estimated this multiple linear model:$\hat{GINIW_{2010}} = \hat{\beta}_0 + \hat{\beta}_1 y_{2010} + \hat{\beta}_2 \text{Unemployment}_{2010} + \hat{\beta}_3 \text{Life Expectancy}_{2010} + \hat{\beta}_4 \text{Infrastructure}_{2010}$.

```{r}
#| echo: false
#| output: false
# Data aquisition: Unemployment (per thousand persons) for Turkey
unemployment <- read_csv("lfst_r_lfu3pers__custom_8264488_linear.csv") |>
  select(id_nuts2 = geo, year = TIME_PERIOD, unemployment = OBS_VALUE)
```

```{r}
#| echo: false
#| output: false
# Data aquisition: Road, rail and inland waterways (km pr thousand square) for Turkey
infrastructure <- read_csv("tran_r_net__custom_8264840_linear.csv") |>
  select(id_nuts2 = geo, year = TIME_PERIOD, infrastructure = OBS_VALUE)
```

```{r}
#| echo: false
#| output: false
# Data aquisition: Life expenctancy (years) for Turkey
life_expectancy <- read_csv("demo_r_mlifexp__custom_8282936_linear.csv") |>
  select(id_nuts2 = geo, year = TIME_PERIOD, life_expectancy = OBS_VALUE)
```

```{r}
#| echo: false
# Join unemployment, infrastructure and life expenctancy datasets
determinants_1 <- unemployment |>
  left_join(infrastructure, join_by(year, id_nuts2))

determinants_2 <- determinants_1 |>
  left_join(life_expectancy, join_by(year, id_nuts2)) |>
  select(year, id_nuts2, unemployment, infrastructure, life_expectancy)
```

```{r}
#| echo: false
# Converting the "year" variable into a character
subset_nuts2_2010$year <- as.character(subset_nuts2_2010$year)
determinants_2$year <- as.character(determinants_2$year)

# Join dataset with determinants with subset_nuts2_2010
TR_nuts2_2010 <- subset_nuts2_2010 |>
  filter(id_nuts0 == "TR", year == "2010") |>
  left_join(determinants_2, join_by(year, id_nuts2))
```

```{r}
#| echo: false
# Clean up
rm(unemployment, infrastructure, life_expectancy, determinants_1, determinants_2)
```

```{r}
#| echo: false
#| label: tbl-mlr
#| tbl-cap: "Multiple Linear Regression"

# Estimate
mlr <- lm(gini_n2 ~ I(gdp_per_capita_n2 * 100) + unemployment + infrastructure + life_expectancy, data = TR_nuts2_2010)
 
# Regression table
huxreg(
  list(Turkey = mlr),
  statistics = c(N = "nobs", R2 = "r.squared"),
  coefs = c(GDPpc = "I(gdp_per_capita_n2 * 100)", Unemployment = "unemployment", Infrastructure = "infrastructure", LifeExpectancy = "life_expectancy", Constant = "(Intercept)"),
  stars = c(`***` = 0.01, `**` = 0.05, `*` = 0.10)
  )

```

The results from the multiple linear regression are reported in @tbl-mlr.
The coefficients provide insights into the direction and strength of the relationship.
The coefficient for GDP per capita is positive, suggesting that a one-unit increase in GDP per capita is associated with a 0.003 increase in the Gini coefficient.
The coefficient for unemployment is -0.000, suggesting an extremely small negative effect or no effect at all.
The coefficient for infrastructure is negative at -0.001.
This is a small effect, suggesting that a one-unit increase in infrastructure is associated with a decrease of 0.001 in regional inequality.
The coefficient for life expectancy shows a negative relationship.
A one-unit increase in life expectancy is associated with a decrese of 0.003 in regional inequality.
None of the coefficients in the @tbl-mlr are statistically significant.
The R2 value of 0.150 suggests that approximately 15% of the variability in the dependent variable is accounted for by the independent variables included in the regression.
The remaining 85% of the variation is not explained by the variables included in the model.

### Alternative functional forms

We explored functional forms for the EU countries and the United Kingdom.
Since the number of observations for each of the EU-countries are small, we decided to stick to a model with all the EU countries together.
We estimated a logarithmic model for the EU countries, and a quadratic model for the United Kingdom.

***Logarithmic regression model***

The logarithmic form suits models where diminishing returns or asymptotic behaviour is expected.
In our simple linear regression model for the EU countries (see @tbl-slr) we have a negative relationship where higher levels of regional development are associated with lower levels of inequality.
We therefore chose a logarithmic model for the EU countries.
The logarithmic model used is: $\hat{GINIW_{2010}} = \hat{\beta}_0 + \hat{\beta}_1 log(y_{2010})$.
This is a level log model.

```{r}
#| echo: false
#| label: tbl-log
#| tbl-cap: Logarithmic regression model
# Logarithmic model for EU countries
lm_log_EU <- lm(gini_n2 ~ log(gdp_per_capita_n2 * 100), data = subset_nuts2_2010 %>% filter(id_nuts0 %in% c("CZ", "FI", "TR")))

huxreg(
  list("EU" = lm_log_EU),
  statistics = c(N = "nobs", R2 = "r.squared"),
  coefs = c("log(GDPpc)" = "log(gdp_per_capita_n2 * 100)", Constant = "(Intercept)"),
  stars = c(`***` = 0.01, `**` = 0.05, `*` = 0.10)
  )
```

The results from the logarithmic regression model are reported in @tbl-log.
Since it is a level-log model, a one-percent increase in $y_{2010}$ leads to a $\hat{\beta}_1$ รท 100-unit increase in $\hat{GINIW_{2010}}$.
The coefficient for the log(GDPpc) is -0.020.
This negative relationships indicates an inverse relationship.
As the GDP per capita increases by 1%, the Gini coefficient is expected to decrease by 0.020%.
This relationship is statistically significant at a 5% level.
The constant term has a coefficient of 0.038 and is statistically significant at a 1% level.
For log(GDPpc), the standard error is 0.008, and for the constant, it is 0.005.
The R-squared value is 0.164, suggesting that the model explains about 16.4% of the variance in EU.

***Quadratic regression model***

The quadratic form is used in situations where there is a curvature relationship between variables.
We thought that a quadratic from was suitable for the UK, because we expected an inverted U-shape, like the Kuznest curve.
The equation for the quadratic model is: $\hat{GINIW_{2010}} = \hat{\beta}_0 + \hat{\beta}_1 y_{2010} + \hat{\beta}_2 y_{2010}^2$.

```{r}
#| echo: false
#| label: tbl-quad
#| tbl-cap: Quadratic regression model
# Quadratic model for the UK
lm_quad_UK <- lm(gini_n2 ~ gdp_per_capita_n2 + I((gdp_per_capita_n2 * 100)^2), data = subset_nuts2_2010 %>% filter(id_nuts0 == "UK"))

huxreg(
  list("UK" = lm_quad_UK),
  statistics = c(N = "nobs", R2 = "r.squared"),
  coefs = c("GDPpc" = "gdp_per_capita_n2", "GDPpc^2" = "I((gdp_per_capita_n2 * 100)^2)",
            Constant = "(Intercept)"),
  stars = c(`***` = 0.01, `**` = 0.05, `*` = 0.10)
  )
```

The results from the quadratic regression model is reported in @tbl-quad.
The positive coefficient for GDP per capita (GDPpc) suggests a initial positive relationship, while the negative coefficient for the GDP per capita squared (GDPpc\^2) introduces a quadratic term, indicating a curvature in the relationship.
The coefficient for the GDP per capita is 4.425, indicating that as GDP per capita increases by one unit, the Gini coefficient is expected to increase by 4.425 units.
This relationship is significant at a 10% level.
The GDP per capita squared (GDPpc\^2) is -0.001, suggesting a quadratic relationship.
As GDP per capita increases, the Gini coefficient initally rises, but at a certain point the Gini coefficient will become negative and start to decrease.
This gives a inverted U-shape, like the Kuznets curve.
The model has a good fit with an R-squared value of 0.604, suggesting that around 60.4% of the variation in the Gini coefficient is explained by the model.

### Panel estimates

The panel estimation in the analysis involves exploring the relationship between regional development (measured by GDP per capita) and regional inequality (measured by the population-weighted GDP Gini coefficient) across time and regions.
The panel data structure allows for the examination of both cross-sectional and time-series variations in the data.

```{r}
#| echo: false
#| output: false
#| message: false
# Convert data to pdata.frame
pdata <- pdata.frame(main_data_nuts2, index = c("id_nuts0", "id_nuts2", "year"))
options(warn = 0)
```

```{r}
#| echo: false
#| output: false
#| message: false
# Separate Fixed Effects Models

# 1. Individual (Country) Fixed Effects
model_ind <- plm(gini_n2 ~ gdp_per_capita_n2, data = main_data_nuts2, index = c("id_nuts0", "year"), model = "within")

# 2. Time Fixed Effects
model_time <- plm(gini_n2 ~ gdp_per_capita_n2, data = main_data_nuts2, index = c("id_nuts0", "year"), model = "within")

# 3. NUTS 2 Level Fixed Effects
model_nuts2 <- plm(gini_n2 ~ gdp_per_capita_n2, data = main_data_nuts2, index = c("id_nuts0", "id_nuts2", "year"), model = "within")

# Joint Fixed Effects Model

# 4. Joint (Country, NUTS 2, and Time) Fixed Effects
model_joint <- plm(gini_n2 ~ gdp_per_capita_n2, data = main_data_nuts2, index = c("id_nuts0", "id_nuts2", "year"), model = "within")

# Store the models in a list
models_list <- list(
  "Individual FE" = model_ind,
  "Time FE" = model_time,
  "NUTS 2 Level FE" = model_nuts2,
  "Joint FE" = model_joint
)
```

```{r}
#| echo: false
# Store the models in a list
models_list <- list(
  "Individual FE" = model_ind,
  "Time FE" = model_time,
  "NUTS 2 Level FE" = model_nuts2,
  "Joint FE" = model_joint
)

# Function to print clean summaries
print_clean_summary <- function(model) {
  cat("\nSummary for", deparse(model$call$formula), "\n")
  tidy_summary <- tidy(model)
  print(tidy_summary[, c("term", "estimate", "std.error", "statistic", "p.value")])
}

# Print clean summaries for each model
invisible(lapply(models_list, print_clean_summary))
```

### **Model 1: Individual Fixed Effect (id_nuts0)**

**Coefficient of gdp_per_capita_n2:** The coefficient is 2.617631, and it is statistically significant (p-value \< 2.2e-16).
This implies a positive relationship between regional development (measured by GDP per capita) and regional inequality (measured by the Gini coefficient) when considering individual fixed effects.

### **Model 2: Individual Fixed Effect (id_nuts0, year)**

**Coefficient of gdp_per_capita_n2:** The coefficient remains 2.617631, and it remains statistically significant (p-value \< 2.2e-16).
Including the fixed effect for the year doesn't alter the interpretation.
The positive relationship between regional development and regional inequality persists after controlling for individual and time fixed effects.

### **Model 3: Individual and Group Fixed Effects (id_nuts0, id_nuts2, year)**

**Coefficient of gdp_per_capita_n2:** Similar to the previous models, the coefficient remains 2.617631, and it is statistically significant (p-value \< 2.2e-16).
Even with the inclusion of group fixed effects, the positive relationship between regional development and regional inequality holds.

### **Joint Interpretation:**

**Consistent Positive Relationship:** In all models, the coefficient of gdp per capita is positive and statistically significant.
This consistent result across different fixed effects suggests a robust positive relationship between regional development and regional inequality.

# IV. Empirical Findings

## Cross-sectional Estimates

### Simple Linear Regression

```{r}
#| echo: false
#| message: false
#| label: fig-slm-all
#| fig-cap: "Simple Linear Regression for All Countries"
# Plot for all countries
plot_all <- subset_nuts2_2010 %>%
  ggplot(aes(x = I(gdp_per_capita_n2 * 100), y = gini_n2, color = id_nuts2)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, linetype = "dashed", color = "black") +
  labs(title = "Regression Model for All Countries",
       x = "GDP per Capita",
       y = "GDP Gini Coefficient",
       color = "NUTS2 region")

plot_all
```

@fig-slm-all visualize the relationship between regional development and regional inequality for NUTS 2 regions in the year 2010 for all the countries.
The figure have GDP per capita on the x-axis and Gini coefficient on the y-axis.
The black line represent the estimated relationship.
The figure shows a positive relationship between regional development and regional inequality.

```{r}
#| echo: false
#| message: false
#| label: fig-slm-UK
#| fig-cap: "Simple Linear Regression for the United Kingdom"
# Plot for the UK
plot_UK <- subset_nuts2_2010 %>%
  filter(id_nuts0 == "UK") %>%
  ggplot(aes(x = I(gdp_per_capita_n2 * 100), y = gini_n2, color = id_nuts2)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, linetype = "dashed", color = "black") +
  labs(title = "Regression Model for the UK",
       x = "GDP per Capita",
       y = "GDP Gini Coefficient",
       color = "NUTS2 Regions") 

plot_UK
```

@fig-slm-UK illustrates the connection between regional development and inequality within NUTS 2 regions for the UK in the year 2010.
Plotted with GDP per capita on the x-axis and the Gini coefficient on the y-axis, the black line signifies the estimated relationship between these two variables.
The line confirms a positive relationship.

```{r}
#| echo: false
#| message: false
#| label: fig-slm-EU
#| fig-cap: "Simple Linear Regression for the EU Countries"
# Plot for the EU countries
plot_EU <- subset_nuts2_2010 %>%
  filter(id_nuts0 %in% c("CZ", "FI", "TR")) %>%
  ggplot(aes(x = I(gdp_per_capita_n2 * 100), y = gini_n2, color = id_nuts2)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, linetype = "dashed", color = "black") +
  labs(title = "Regression Model for EU Countries",
       x = "GDP per Capita",
       y = "GDP Gini Coefficient",
       color = "NUTS2 Regions")

plot_EU
```

@fig-slm-EU visualize the relationship between regional development and regional inequality for NUTS 2 regions in the year 2010 for the EU countries.
With GDP per capita on the x-axis and Gini coefficient on the y-axis, the black line serves the estimated relationship between these two.
We can see from the figure that the relationship is negative.

### Multiple Linear Regression

```{r}
#| echo: false
#| message: false

# Multiple linear regression model
ML_regressionmodel <- TR_nuts2_2010

mlr <- lm(gini_n2 ~ I(gdp_per_capita_n2 * 100) + I(unemployment * 100) + I(infrastructure * 100) + I(life_expectancy * 100), data = ML_regressionmodel)

```

```{r}
#| echo: false
#| message: true
#| label: fig-mlr-plot
#| fig-cap: "Multiple Linear Regression Model Plot for Turkey"

# Predicting values using the multiple regression model
ML_regressionmodel$predicted <- predict(mlr)

# Plotting actual vs predicted values
plot_mlr <- ggplot(ML_regressionmodel, aes(x = I(gdp_per_capita_n2 * 100), y = gini_n2, color = id_nuts2)) +
  geom_point() +
  geom_smooth(aes(y = predicted), method = "lm", se = FALSE, linetype = "dashed", color = "black") +
  labs(title = "Multiple Linear Regression Model for Turkey",
       x = "GDP per Capita",
       y = "GDP Gini Coefficient",
       color = "NUTS2 Regions")

plot_mlr

```

@fig-mlr-plot portrays the association between various socio-economic factors and regional inequality in NUTS 2 regions in Turkey.
The x-axis represents GDP per Capita, while the y-axis corresponds to the GDP Gini Coefficient.
The dashed black line symbolizes the estimated relationship derived from the multiple linear regression model, incorporating variables such as GDP per Capita, unemployment, infrastructure, and life expectancy.
The scatter points showcase the observed data for different NUTS 2 regions, each uniquely identified by color.
The figure shows a negative relationship between the various socio-economic factors and regional inequality.

**Cross-Sectional Analysis Summary:**

The cross-sectional exploration undertaken in this study yields profound insights into the intricate nexus between regional development and inequality across NUTS 2 regions in the year 2010, encompassing a comprehensive analysis through both simple and multiple linear regression models.

**Simple Linear Regression Results:**

*For All Countries:*

The visual representation in Figure @fig-slm-all encapsulates a positive correlation between regional development, epitomized by GDP per capita, and the concomitant regional inequality, as measured by the GDP Gini coefficient.
The discernible black dashed line serves as a visual manifestation of the estimated relationship.

*For the United Kingdom (UK):*

Figure @fig-slm-UK unveils a parallel positive association within the UK context, mirroring the overarching trend.
Here, the black dashed line signifies the trajectory of the estimated relationship, aligning with expectations.

*For EU Countries (Czech Republic, Finland, Turkey):*

A notable departure from the overarching trend is observed in the EU countries, as illustrated in Figure @fig-slm-EU. Contrary to conventional expectations, these nations exhibit a negative correlation between regional development and inequality, introducing a layer of complexity and emphasizing the need to recognize distinct dynamics within diverse country groups.

**Multiple Linear Regression Results for Turkey:**

Within the Turkish context, the multiple linear regression model, as depicted in Figure @fig-mlr-plot, delves into a multidimensional exploration.
Here, the interplay of various socio-economic factors---namely GDP per capita, unemployment, infrastructure, and life expectancy---reveals a compelling negative relationship with the GDP Gini coefficient.
In essence, higher GDP per capita, lower unemployment, enhanced infrastructure, and increased life expectancy collectively contribute to a mitigated level of regional inequality.

**Key Observations:**

The affirming positive correlation observed in the overall analysis and the UK aligns seamlessly with conventional expectations, positing that heightened regional development invariably corresponds to elevated regional inequality.

Conversely, the EU countries present a paradigm shift, portraying a counterintuitive negative relationship, thereby prompting a reevaluation of traditional assumptions and emphasizing the need for nuanced insights.

The multifaceted perspective afforded by the multiple linear regression for Turkey underscores the significance of a holistic approach.
Acknowledging the interplay of diverse socio-economic factors is crucial for a nuanced understanding of regional inequality.

**Implications and Further Considerations:**

These cross-sectional findings underscore the imperative nature of tailoring analytical frameworks to accommodate country-specific dynamics, steering away from broad generalizations in our understanding of the interplay between regional development and inequality.

The paradoxical negative relationship in the EU countries prompts a call for an in-depth investigation into the nuanced contextual factors that underpin regional dynamics, challenging and expanding the existing discourse.

In the Turkish context, the multiple linear regression model underscores the indispensability of adopting a comprehensive perspective.
The interrelated nature of socio-economic factors necessitates a holistic consideration for formulating effective policies addressing regional inequality.

## Alternative Functional Forms and Panel Estimates

### Logarithm Regression Model

```{r}
#| echo: false
#| message: false
#| label: fig-log-EU
#| fig-cap: "Logarithm Regression Model for the EU countries"
# Plot for the EU countries
plot_EU_log <- subset_nuts2_2010 %>%
  filter(id_nuts0 %in% c("CZ", "FI", "TR")) %>%
  ggplot(aes(x = (log(gdp_per_capita_n2 * 100)), y = gini_n2, color = id_nuts2)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, linetype = "dashed", color = "black") +
  labs(title = "Logarithmic Regression Model for EU Countries",
       x = "Log(GDP per Capita)",
       y = "GDP Gini Coefficient",
       color = "NUTS2 Regions")
plot_EU_log
```

The logaritmic model for the EU countries is visualizsed in @fig-log-EU, with the logarithm of GDP per capita on the x-axis and the GDP Gini coefficient on the y-axis.
We can see from the figure that the relationship is negative

### Quadratic Regression Model

```{r}
#| echo: false
#| message: false
#| label: fig-quad-UK
#| fig-cap: "Quadratic Model for the United Kingdom"
# Plot for the UK
plot_UK_quad <- subset_nuts2_2010 %>%
  filter(id_nuts0 == "UK") %>%
  ggplot(aes(x = I((gdp_per_capita_n2 * 100)^2), y = gini_n2, color = id_nuts2)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x + I(x^2), se = FALSE, linetype = "dashed", color = "black") +
  labs(title = "Quadratic Regression Model for UK",
       x = "GDP per Capita^2",
       y = "GDP Gini Coefficient",
       color = "NUTS2 Regions")
plot_UK_quad
```

The quadratic model is visualized in @fig-quad-UK , with the square of GDP per capita on the x-axis, and the GDP Gini coefficient on the y-axis.
We can see from the figure that the relationship is positive and u-shaped before 150 in GDP per capita and a negative trend after.

**Exploring Alternative Functional Forms and Panel Estimates:**

In the pursuit of a more nuanced understanding of the intricate relationship between regional development and inequality across NUTS 2 regions in 2010, this study extends its analytical framework to encompass alternative functional forms.
Specifically, logarithmic and quadratic regression models are employed to extract richer insights.

**Logarithmic Regression Model for EU Countries:**

Illustrated in Figure @fig-log-EU, the logarithmic regression model for EU countries introduces the logarithm of GDP per capita on the x-axis and the GDP Gini coefficient on the y-axis.
Notably, the figure reveals a discernible negative relationship, indicating that as the logarithm of GDP per capita increases, regional inequality tends to decrease.
Salient insights include:

-   The logarithmic transformation offers a distinctive lens, exposing a negative correlation between the logarithm of GDP per capita and the GDP Gini coefficient.

-   Within the context of EU countries, this model posits that the impact of economic growth on reducing regional inequality weakens as GDP per capita increases.

**Quadratic Regression Model for the United Kingdom:**

As depicted in Figure @fig-quad-UK, the quadratic regression model for the United Kingdom employs the square of GDP per capita on the x-axis and the GDP Gini coefficient on the y-axis.
The revelations drawn from this model are particularly intriguing:

-   The depicted relationship unfolds as positive and u-shaped before hitting a GDP per capita threshold of 150.
    Beyond this point, the relationship takes a negative turn.

-   The u-shaped pattern implies that with initial increases in GDP per capita, regional inequality rises, reaching a zenith at the vertex of the curve.
    Subsequent economic growth is then associated with a decline in regional inequality.

**Synthesis of Key Findings:**

*Functional Form Sensitivity:* The choice of functional form exerts a profound influence on our comprehension of the regional development-inequality nexus.
The negative relationship unveiled by the logarithmic model challenges conventional linear assumptions, underscoring the imperative for nuanced modeling.

*Threshold Dynamics:* The quadratic model for the UK unravels a threshold effect, suggesting a qualitative shift in the relationship between GDP per capita and regional inequality beyond a specific economic threshold.

# V. Discussion

## Key Insights

**Regional Development and Inequality Dynamics:** The analysis reveals a nuanced relationship between regional development and inequality.
The simple linear regression models for all countries and the United Kingdom indicate a positive association between regional development (measured by GDP per capita) and regional inequality (measured by the population-weighted GDP Gini coefficient).
However, the model for EU countries suggests a negative association, introducing complexity into the dynamics.

**Determinants of Regional Inequality:** The multiple linear regression for Turkey introduces additional determinants, such as unemployment, infrastructure, and life expectancy.
While the coefficients are generally small and not statistically significant, the negative coefficient for life expectancy suggests a potential role in reducing regional inequality.

**Alternative Functional Forms:** Exploring alternative functional forms provides further insights.
The logarithmic model for EU countries suggests an inverse relationship, emphasizing diminishing returns in the context of regional development.
In contrast, the quadratic model for the United Kingdom presents an inverted U-shape, akin to the Kuznets curve, indicating a more complex trajectory of regional inequality.

**Panel Estimates:** Across various model specifications, including individual and group fixed effects, the panel estimates consistently reveal a robust and statistically significant positive relationship between regional development, measured by GDP per capita, and regional inequality, represented by the Gini coefficient.
This finding underscores the resilience of the positive association over time and across different regional contexts, providing a comprehensive understanding of the nuanced dynamics in regional development and inequality

## Policy Implications

**Tailored Policy Approaches:** The varying relationships observed across different models and countries underline the importance of tailored policy approaches.
One-size-fits-all strategies may not effectively address the multifaceted nature of regional development and inequality.
Policymakers should consider the specific context of each region when designing interventions.

**Incorporating Determinants:** While the determinants introduced in the multiple linear regression model for Turkey did not show strong significance, the negative relationship with life expectancy suggests potential avenues for policy intervention.
Investing in healthcare and improving life expectancy might contribute to reducing regional inequality.

**Long-Term Vision:** The quadratic model's depiction of an inverted U-shape implies that there might be a threshold in regional development beyond which inequality decreases.
Policymakers should have a long-term vision, understanding that certain levels of development may trigger positive changes in regional inequality.

**Continuous Monitoring:** The use of panel estimates underscores the importance of continuous monitoring and evaluation.
Regional development and inequality are dynamic processes influenced by various factors over time.
Policymakers should regularly reassess the impact of interventions and adjust strategies accordingly.

**Global Relevance:** Insights from the study not only contribute to the understanding of the specified countries but also have broader implications globally.
Policymakers in other nations facing similar challenges can draw lessons from these findings, fostering a more collaborative and informed approach to regional development.

# VI. Limitations and Future Research

## Research Limitations

While our study aimed to provide valuable insights into the intricate dynamics of regional development and inequality within the Czech Republic, Turkey, Finland, and the United Kingdom, it is important to acknowledge certain constraints and limitations inherent in our analysis.
Firstly, variations in data collection methods between Eurostat and the Office for National Statistics (ONS), as well as potential differences in classification systems between the EU and the United Kingdom, might introduce uncertainties and affect the comparability of data.
Despite efforts to align International Territorial Levels (ITLs) with Nomenclature of Territorial Units for Statistics (NUTS), subtle differences could impact the accuracy of our findings.
Additionally, the shift in currency units for GDP data between EU countries (million euros) and the United Kingdom (million pounds) may introduce complexities that were not fully addressed in our data manipulation.
Furthermore, our exploration of determinants of regional inequality was constrained by the availability of data, particularly for variables like unemployment, infrastructure, and life expectancy.
The limited number of observations in some models, especially in the case of the logarithmic regression for EU countries, may affect the robustness of our conclusions.
It is essential to interpret our results with caution, considering these constraints, and future research endeavors should aim to address these limitations for a more comprehensive understanding of regional dynamics.

# VII. Conclusion

## Summary

In this econometric analysis of regional development and inequality across Czech Republic, Turkey, Finland, and the United Kingdom, we explored the intricate dynamics using a variety of models and methodologies.
Our primary datasets from Eurostat and the Office for National Statistics (ONS) were merged, accounting for the post-Brexit shift in classification systems from NUTS to International Territorial Levels (ITLs).
Despite efforts to align these classifications, potential differences may impact comparability.

The initial focus involved computing GDP per capita as a measure of regional development and the population-weighted GDP Gini coefficient to gauge regional inequality.
Simple linear regression models revealed a positive association between regional development and inequality for all countries and the UK, while a negative association was observed for EU countries, introducing complexity.
Further, a multiple linear regression model in Turkey incorporated unemployment, infrastructure, and life expectancy as determinants, though their impact was generally small and statistically insignificant.

Exploring alternative functional forms, a logarithmic model for EU countries emphasized diminishing returns, while a quadratic model for the UK suggested an inverted U-shaped relationship reminiscent of the Kuznets curve.
Panel estimates allowed us to examine both cross-sectional and time-series variations, providing a comprehensive view of regional dynamics.

## Final Reflections

Our research journey unveiled multifaceted relationships between regional development and inequality, challenging conventional expectations.
The positive link observed in the overall analysis and the UK contradicted the negative association within EU countries.
This paradox emphasizes the importance of contextual nuances and calls for a nuanced policy approach.

The inclusion of additional determinants in the multiple linear regression for Turkey, while yielding statistically insignificant results, hinted at potential factors influencing regional inequality.
The exploration of alternative functional forms added depth, revealing non-linearities that might have been overlooked in a conventional linear framework.

The panel estimation approach further enriched our understanding by considering both temporal and spatial dimensions.
However, the study is not without limitations.
Differences in data collection methods and classification systems, along with constraints in available data for certain determinants, introduce uncertainties.

In conclusion, our study contributes to the field of regional development and inequality by offering a nuanced perspective, acknowledging the intricacies within and between countries.
Our findings underscore the importance of tailored policy interventions, recognizing the unique dynamics at play in each region.
As we conclude this research endeavor, the path forward involves addressing data limitations, refining models, and expanding the scope to unravel the complexities of regional dynamics more comprehensively.

# VIII. References
